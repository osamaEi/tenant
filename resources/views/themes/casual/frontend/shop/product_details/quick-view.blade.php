<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',"");</script>
    <!-- End Google Tag Manager -->







    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="canonical" href="https://www.baby40.amstechs.com/shop/product/5" />

    
    <link rel="preconnect" href="https://fonts.gstatic.com"> <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200&display=swap" rel="stylesheet">
    <link rel="icon" href="https://baby40.amstechs.com/assets/tenant/uploads/media-uploader/baby40/frame-321684825828.png" type="image/png">

    <title>
                    سلوبيت فرداني قطن
            -
            Baby Yummy
            </title>

    <link rel="icon" href="https://baby40.amstechs.com/assets/tenant/uploads/media-uploader/baby40/frame-321684825828.png" type="image/png">

    
            <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/bootstrap.min.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/animate.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/slick.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/nice-select.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/line-awesome.min.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/common/css/jquery.ihavecookies.css">
                            <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/helpers.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/common/css/toastr.css">
                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/common/css/loader.css">
    
    <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/footer-style.css">

            <link rel="stylesheet" href="https://baby40.amstechs.com/shop/assets/css/style" type="text/css" />
    
                        <link rel="stylesheet" href="https://baby40.amstechs.com/shop/assets/css/rtl" type="text/css" />
            
<!-- add Zoom plugin -->
    <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/image-zoom.css">
    
    <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/custom-style.css">

                   <meta property="meta_title" content="">
       <meta property="og:image"content="">
       <meta property="meta_description" content="">
       <!--Facebook-->
       <meta property="og:url"content="https://baby40.amstechs.com" >
       <meta property="og:type"content="" >
       <meta property="og:title"content="" >
       <meta property="og:description"content="" >
       <meta property="og:image"content="">
       <!--Twitter-->
       <meta name="twitter:site" content="https://baby40.amstechs.com" >
       <meta name="twitter:title" content="" >
       <meta name="twitter:description" content="">
       <meta name="twitter:image" content="">
    
    <style>
    :root {
        --main-color-one: rgb(248, 58, 38);
        --main-color-two: rgb(255, 186, 0);
        --main-color-three: rgb(255, 106, 58);
        --main-color-four: rgb(255, 105, 92);
        --secondary-color: #F7A3A8;
        --secondary-color-two: #ffdcd2;
        --feedback-bg-item: rgb(51, 51, 51);
        --section-bg-1: rgb(237, 22, 22);
        --section-bg-2: #FFF6EE;
        --section-bg-3: #F4F8FB;
        --section-bg-4: #F2F3FB;
        --section-bg-5: #F9F5F2;
        --section-bg-6: #E5EFF8;
        --breadcrumb-bg: #E5EFF8;
        --heading-color: rgb(216, 164, 9);
        --body-color: #666666;
        --light-color: #666666;
        --extra-light-color: rgb(153, 153, 153);
        --review-color: #FABE50;
        --new-color: #5AB27E;
        --heading-font: "Cairo", serif;
        --body-font: "Cairo", sans-serif;
    }
</style>

    <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/shop-order-custom.css">
            <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/digital-shop-common.css">
        <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/shop-common.css">
    

    <link rel="stylesheet" href="https://baby40.amstechs.com/assets/common/css/star-rating.min.css">

<style>
    :root {
        --gl-star-size: 35px;
        --gl-tooltip-border-radius: 4px;
        --gl-tooltip-font-size: 0.875rem;
        --gl-tooltip-font-weight: 400;
        --gl-tooltip-line-height: 1;
        --gl-tooltip-margin: 12px;

        --gl-tooltip-padding: .3em 1em;
        --gl-tooltip-size: 6px;
    }
    
    .slider-inner-margin .slick-list {
            width: 182% !important;
    }
    .gl-star-rating--stars span {
        margin-right: 5px !important;
    }

    .campaign_countdown_wrapper {
        text-align: center;
        z-index: 95;
    }

    .campaign_countdown_wrapper .global-timer .syotimer__body {
        gap: 10px 15px;
        -webkit-box-pack: justify;
        -ms-flex-pack: justify;
        justify-content: space-between;
    }

    .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell {
        background-color: rgba(var(--main-color-two-rgb), .1);
        padding: 10px 20px;
        min-width: 100px;
    }

    @media (min-width: 1400px) and (max-width: 1599.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body {
            gap: 10px;
        }
    }

    @media (min-width: 1200px) and (max-width: 1399.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body {
            gap: 10px;
        }
    }

    @media (min-width: 992px) and (max-width: 1199.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body {
            gap: 10px;
        }
    }

    @media (min-width: 300px) and (max-width: 991.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body {
            gap: 10px;
        }
    }

    .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__value {
        font-size: 32px;
        line-height: 36px;
    }

    @media (min-width: 1400px) and (max-width: 1599.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__value {
            font-size: 28px;
        }
    }

    @media (min-width: 1200px) and (max-width: 1399.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__value {
            font-size: 28px;
        }
    }

    @media (min-width: 992px) and (max-width: 1199.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__value {
            font-size: 28px;
        }
    }

    @media (min-width: 300px) and (max-width: 991.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__value {
            font-size: 28px;
        }
    }

    .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__unit {
        font-size: 18px;
        line-height: 28px;
    }

    @media (min-width: 1400px) and (max-width: 1599.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__unit {
            font-size: 16px;
        }
    }

    @media (min-width: 1200px) and (max-width: 1399.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__unit {
            font-size: 16px;
        }
    }

    @media (min-width: 992px) and (max-width: 1199.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__unit {
            font-size: 16px;
        }
    }

    @media (min-width: 300px) and (max-width: 991.98px) {
        .campaign_countdown_wrapper .global-timer .syotimer__body .syotimer-cell .syotimer-cell__unit {
            font-size: 16px;
        }
    }

    .shop-details-top-slider .shop-details-thumb-wrapper .shop-details-thums img:hover {
        cursor: zoom-in;
    }

    .zoomed-img {
        cursor: zoom-in;
        transition: transform 0.3s ease;
        max-width: 100%;
        height: auto;
        transform-origin: center center;
    }

    .zoom-container {
        position: relative;
        overflow: hidden;
        max-width: 100%;
        height: auto;
    }

    .zoom-in {
        transform: scale(2);
        cursor: zoom-out;
    }
    
    .shop-details-thums.long-img {
        overflow: hidden;
            width: 500px;

    }
    
    .global-slick-init .slick-track {
            opacity: 1;
    width: 134% !important;
    transform: translate3d(0px, 0px, 0px) !important;
        display: flex;

    }
    
    .slider-inner-margin .slick-slide {
    width:75% !important;
         
    }
    
    
</style>

                <link rel="stylesheet" href="https://baby40.amstechs.com/assets/tenant/frontend/css/baby40/dynamic-style.css">
    
        
</head>

@php
    $data = get_product_dynamic_price($product);
    $campaign_name = $data['campaign_name'];
    $data_regular_price = $data['regular_price'];
    $data_sale_price = $data['sale_price'];
    $discount = $data['discount'];

     $campaign_product = $product?->campaign_product;
     $sale_price = $data_sale_price;
     $deleted_price = $data_regular_price;
     $campaign_percentage = $discount;
     $campaignSoldCount = \Modules\Campaign\Entities\CampaignSoldProduct::where("product_id",$product->id)->first();

     // todo remove it if manage it from inventory from listener
     $stock_count = $campaign_product ? $product?->campaign_product?->units_for_sale - optional($campaignSoldCount)->sold_count ?? 0 : optional($product->inventory)->stock_count;
     $stock_count = $stock_count > 0 ? $stock_count : 0;

     if($campaign_product){
         $campaign_title = \Modules\Campaign\Entities\Campaign::select('id','title')->where("id",$campaign_product?->id)->first();
         $is_expired = $data['is_expired'];
     }

     $quickView = true;
    $image_details = get_attachment_image_by_id($product->image_id, 'full');
@endphp
<div class="modal-dialog modal-xl">
    <div class="modal-content p-5">
        <div class="quick-view-close-btn-wrapper quick-view-details">
            <button class="quick-view-close-btn"><i class="las la-times"></i></button>
        </div>
        <div class="row">
            <div class="col-lg-4 col-xl-5">
                <div class="global-slick-init shop-details-top-slider quick-view-long-img" id="shop_details_gallery_slider" data-asNavFor=".shop-details-click-img" data-fade="true"
                     data-infinite="true" data-autoplaySpeed="3000" data-autoplay="true" data-src="{{ $image_details["img_url"] }}">
                        <div class="quick-view-thumb position-relative">
                            <img src="{{ $image_details["img_url"] }}">
                            <div class="global-card-thumb-badge right-side">
                                <span class="global-card-thumb-badge-box bg-color-two"> 10% Off </span>
                            </div>
                        </div>
                </div>
            </div>

            <div class="col-lg-8 col-xl-7 quick-view-shop-wrapper">
                @include(include_theme_path('shop.product_details.partials.product-options'))
            </div>
        </div>
    </div>
</div>

{{-- new product modal - end --}}

<script>
    // check condition if those variable are declared than no need to declare again
    window.quick_view_attribute_store = JSON.parse('{!! json_encode($product_inventory_set) !!}');
    window.quick_view_additional_info_store = JSON.parse('{!! json_encode($additional_info_store) !!}');
    window.quick_view_available_options = $('.quick-view-value-input-area');
    window.quick_view_has_campaign = '{{ empty($campaign_product) ? 0 : 1 }}';
    window.quick_view_campaign_expired = '{{ isset($is_expired) ? $is_expired : 0 }}';
    window.quick_view_product_id = {{ $product->id }};
    window.quick_view_selected_variant = '';
</script>
    <!-- jquery -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery-3.6.1.min.js"></script>

<script src="https://baby40.amstechs.com/assets/tenant/frontend/js/image-zoom.js"></script>

    <!-- jquery Migrate -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery-migrate-3.4.0.min.js"></script>

    <!-- bootstrap -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/bootstrap.bundle.min.js"></script>

    <!-- Lazyload Js -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery.lazy.min.js"></script>

    <!-- Slick Slider -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/slick.js"></script>



    <!-- All Plugins js -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/wow.js"></script>

    <!-- Nice Select Js -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery.nice-select.js"></script>

    <!-- COuntdown Js -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery.syotimer.min.js"></script>

    <!-- Sweet Alert -->
    <script src="https://baby40.amstechs.com/assets/landlord/common/js/sweetalert2.js"></script>

    <!-- Toastr -->
    <script src="https://baby40.amstechs.com/assets/common/js/toastr.min.js"></script>

    <!-- Nice Scroll -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/jquery.nicescroll.min.js"></script>

    <!-- Range Slider -->
    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/nouislider-8.5.1.min.js"></script>

    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/custom-alert-message.js"></script>


    <script src="https://baby40.amstechs.com/assets/common/js/star-rating.min.js"></script>

    <script src="https://baby40.amstechs.com/assets/common/js/md5.js"></script>

<script src="https://baby40.amstechs.com/assets/common/js/custom-sweetalert-two.js"></script>


    <script src="https://baby40.amstechs.com/shop/assets/js/imagesloaded.pkgd.min"></script>
    <script src="https://baby40.amstechs.com/shop/assets/js/isotope.pkgd.min"></script>
    <script src="https://baby40.amstechs.com/shop/assets/js/main"></script>

<script src="https://baby40.amstechs.com/assets/tenant/frontend/js/digital-shop-common.js"></script>

    <script src="https://baby40.amstechs.com/assets/tenant/frontend/js/baby40/dynamic-script.js"></script>




<script>
    let site_currency_symbol = 'ج.م';

    </script>

<script>
    $(document).on('click', '.newsletter-submit-btn', function (e) {
        e.preventDefault();

        var email = $('.footer-widget input.email').val();

        var errrContaner = $(this).parent().parent().find('.form-message-show');
        errrContaner.html('');
        var el = $(this);

        $.ajax({
            url: "https://baby40.amstechs.com/subscribe-newsletter",
            type: "POST",
            data: {
                _token: "WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi",
                email: email
            },

            beforeSend: function() {
                $('.loader').show();
                el.text('Submiting..');
                el.attr('disabled', true);
            },

            success: function (data) {
                $('.loader').hide();
                $('.email').val('');
                el.text('Subscribe');
                el.attr('disabled', false);
                errrContaner.html('<div class="alert alert-'+data.type+'">' + data.msg + '</div>');
            },
            error: function (data) {
                $('.loader').hide();
                el.text('Subscribe');
                el.attr('disabled', false);
                var errors = data.responseJSON.errors;
                errrContaner.html('<div class="alert alert-danger">' + errors.email[0] + '</div>');
            }
        });
    });
</script>
<script>
    $(document).on('submit', '.custom-form-builder-land', function (e) {
        e.preventDefault();
        var btn = $('#contact_form_btn');
        var form = $(this);
        var formID = form.attr('id');
        var msgContainer =  form.find('.error-message');
        var formSelector = document.getElementById(formID);
        var formData = new FormData(formSelector);
        msgContainer.html('');
        $.ajax({
            url: "https://baby40.amstechs.com/tenant/submit-custom-form",
            type: "POST",
            headers: {
                'X-CSRF-TOKEN': "WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi",
            },
            beforeSend:function (){
                btn.html('<i class="fas fa-spinner fa-spin mr-1"></i> تقديم..');
            },
            processData: false,
            contentType: false,
            data:formData,
            success: function (data) {
                form.find('.ajax-loading-wrap').removeClass('show').addClass('hide');
                msgContainer.html('<div class="alert alert-'+data.type+'">' + data.msg + '</div>');
                btn.text('إرسال رسالة');
                form[0].reset();

            },
            error: function (data) {

                form.find('.ajax-loading-wrap').removeClass('show').addClass('hide');
                var errors = data.responseJSON.errors;
                var markup = '<ul class="alert alert-danger">';

                $.each(errors,function (index,value){
                    markup += '<li>'+value+'</li>';})
                markup += '</ul>';


                msgContainer.html(markup);
                btn.text('إرسال رسالة');
            }
        });
    });
</script>
<script>
    (function($){
        "use strict";
        $(document).ready(function(){
            $(document).on('click','.language_dropdown ul li',function(e){
                var el = $(this);
                el.parent().parent().find('.selected-language').text(el.text());
                el.parent().removeClass('show');
                $.ajax({
                    url : "https://baby40.amstechs.com/lang-change",
                    type: "GET",
                    data:{
                        'lang' : el.data('value')
                    },
                    success:function (data) {

                        location.reload();
                    }
                })
            });
        });
    }(jQuery));
</script>
<script>
    $(function () {
        $(document).ready(function () {
            $(document).on('click', '.physical-explore-category-area .store-tabs .list', function (e) {
                e.preventDefault();

                let el = $(this);
                let tab = el.data('tab');
                let limit = el.data('limit');
                let allId = el.data('all-id');
                let sort_by = el.data('sort_by');
                let sort_to = el.data('sort_to');

                $.ajax({
                    type: 'GET',
                    url: "https://baby40.amstechs.com/category-wise-product/theme-bookpoint/physical",
                    data: {
                        category: tab,
                        limit: limit,
                        allId: allId,
                        sort_by: sort_by,
                        sort_to: sort_to
                    },
                    beforeSend: function () {
                        $('.loader').fadeIn(200);
                    },
                    success: function (data) {
                        let tab = $('li.list[data-tab=' + data.category + ']');
                        let markup_wrapper = $('.physical-explore-category-area .markup_wrapper');

                        $('li.list').removeClass('active');
                        tab.addClass('active');
                        markup_wrapper.hide();
                        markup_wrapper.html(data.markup);
                        markup_wrapper.fadeIn();
                        $('.loader').fadeOut(200);
                    },
                    error: function (data) {
                        console.log('error')
                    }
                });
            });

            $(document).on('click', '.digital-explore-category-area .store-tabs .list', function (e) {
                e.preventDefault();

                let el = $(this);
                let tab = el.data('tab');
                let limit = el.data('limit');
                let allId = el.data('all-id');
                let sort_by = el.data('sort_by');
                let sort_to = el.data('sort_to');

                $.ajax({
                    type: 'GET',
                    url: "https://baby40.amstechs.com/category-wise-product/theme-bookpoint",
                    data: {
                        category: tab,
                        limit: limit,
                        allId: allId,
                        sort_by: sort_by,
                        sort_to: sort_to
                    },
                    beforeSend: function () {
                        $('.loader').fadeIn(200);
                    },
                    success: function (data) {
                        let tab = $('li.list[data-tab=' + data.category + ']');
                        let markup_wrapper = $('.digital-explore-category-area .markup_wrapper');

                        $('li.list').removeClass('active');
                        tab.addClass('active');
                        markup_wrapper.hide();
                        markup_wrapper.html(data.markup);
                        markup_wrapper.fadeIn();
                        $('.loader').fadeOut(200);
                    },
                    error: function (data) {
                        console.log('error')
                    }
                });
            });
        });
    });
</script>

    <script>
        $(function () {
            $(document).on('click', '.product-list .list', function (e) {
                e.preventDefault();

                let el = $(this);
                let tab = el.data('tab');
                let limit = el.data('limit');
                let sort_by = el.data('sort_by');
                let sort_to = el.data('sort_to');
                let allId = el.data('all-id');

                const url = `https://baby40.amstechs.com/category-wise-product/theme-casual`;

                $.ajax({
                    type: 'GET',
                    url: url,
                    data: {
                        category: tab,
                        limit: limit,
                        sort_by: sort_by,
                        sort_to: sort_to,
                        allId: allId
                    },
                    beforeSend: function () {
                        $('.loader').fadeIn(200);
                    },
                    success: function (data) {
                        let tab = $('li.list[data-tab='+data.category+']');
                        let markup_wrapper = $('.markup_wrapper');

                        $('li.list').removeClass('active');
                        tab.addClass('active');
                        markup_wrapper.hide();
                        markup_wrapper.html(data.markup);
                        markup_wrapper.fadeIn();
                        $('.loader').fadeOut(200);
                    },
                    error: function (data) {
                        console.log('error')
                    }
                });
            });
        });
    </script>

<script>
    let images = document.querySelectorAll(".blurred-img");
    images.forEach(function (e, t) {
        let img = images[t].querySelector('img');
        if (img.complete)
        {
            e.classList.add("loaded")
        }
        else
        {
            // if the img.complete is not true then wait until image loaded
            img.addEventListener("load", function () {
                e.classList.add("loaded")
            });
        }
    });
</script>

<script>
    toastr.options = {
        "closeButton": true,
        "debug": false,
        "newestOnTop": true,
        "progressBar": true,
        "positionClass": "toast-top-right",
        "preventDuplicates": true,
        "onclick": null,
        "showDuration": "300",
        "hideDuration": "1000",
        "timeOut": "2000",
        "extendedTimeOut": "2000",
        "showEasing": "swing",
        "hideEasing": "linear",
        "showMethod": "slideDown",
        "hideMethod": "slideUp"
    };

    $(function (){
        $(document).on('keyup', '#search_form_input', function (e){
            e.preventDefault();

            let search_text = $(this).val();

            $.ajax({
                url: 'https://baby40.amstechs.com/search',
                type: 'GET',
                data: {
                    search: search_text
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if(data.product_object.length > 0)
                    {
                        $('.product-suggestion-list').html(data.markup);
                    }
                }
            });
        });

        // Compare Product
        $(document).on('click', '.quick-view-compare-btn', function (e) {
            e.preventDefault();

            let quick_view_has_campaign = '0';
            let quick_view_campaign_expired = '0';

            if(quick_view_has_campaign === 1){
                if (quick_view_campaign_expired === 0){
                    toastr.error('The campaign is over, Sorry! you can not cart this product');
                    return false;
                }
            }

            let selected_size = $('#selected_size').val();
            let selected_color = $('#selected_color').val();

            let pid_id = getQuickViewAttributesForCart();

            let product_id = quick_view_product_id;
            let quantity = Number($('#quick-view-quantity').val().trim());
            let price = $('#price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;
            let productAttribute = quick_view_selected_variant;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (quickViewValidateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/compare/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    beforeSend: function () {

                    },
                    success: function (data) {
                        if (data.quantity_msg)
                        {
                            toastr.warning(data.quantity_msg);
                        }
                        else if(data.error_msg)
                        {
                            toastr.error(data.error_msg);
                        }
                        else
                        {
                            toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                            $('.track-icon-list').load(location.href + " .track-icon-list");
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ')
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس')
            }
        });


        $(document).on('click', '.compare-btn', function (e) {
            e.preventDefault();

            let pid_id = null;
            let product_id = $(this).data("product_id");
            let quantity = 1;
            let product_variant = null;

            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/compare/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: null,
                    selected_color: null,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        $('.track-icon-list').load(location.href + " .track-icon-list");
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });

        });

        $(document).on('click', '.add-to-wishlist-btn', function (e) {
            e.preventDefault();

            let pid_id = null;
            let product_id = $(this).data("product_id");
            let quantity = 1;
            let product_variant = null;

            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/wishlist/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: null,
                    selected_color: null,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        $('.track-icon-list').load(location.href + " .track-icon-list");
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });

        });

        $(document).on('click', '.add-to-cart-btn', function (e) {
            e.preventDefault();

            let pid_id = null;
            let product_id = $(this).data("product_id");
            let quantity = 1;
            let product_variant = null;

            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/cart/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: null,
                    selected_color: null,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        $('.track-icon-list').load(location.href + " .track-icon-list");
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });

        });

        $(document).on('click', '.digital-add-to-cart-btn', function (e) {
            e.preventDefault();

            let product_id = $(this).data("product_id");

            $.ajax({
                url: 'https://baby40.amstechs.com/shop/digital/product/cart/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        let track_icon_list = $('.track-icon-list');
                        track_icon_list.hide();
                        track_icon_list.load(location.href + " .track-icon-list");
                        track_icon_list.fadeIn();
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });
        });

        function storeIntoSession(product_id) {
            let arrItem = [];

            if(sessionStorage.length === 0)
            {
                sessionStorage.setItem('products', product_id);
            } else {
                arrItem.push(sessionStorage.getItem('products'));
                arrItem.push(product_id);
                sessionStorage.setItem('products', arrItem);
            }

            return sessionStorage.getItem('products');
        }
    });

    $(document).on('click', '.social_share_parent', function (e){
        $('.social_share_wrapper_item').toggleClass('show');
    });

    $('body').on('click', '.quick-view-size-lists li', function (event) {
        let el = $(this);
        let value = el.data('displayValue');
        let parentWrap = el.parent().parent();
        el.addClass('active');
        el.siblings().removeClass('active');
        parentWrap.find('input[type=text]').val(value);
        parentWrap.find('input[type=hidden]').val(el.data('value'));

        // selected attributes
        selectedAttributeSearch(this);
    });

    function selectedAttributeSearch(selected_item) {
        /*
        * search based on all selected attributes
        *
        * 1. get all selected attributes in {key:value} format
        * 2. search in attribute_store for all available matches
        * 3. display available matches (keep available matches selectable, and rest as disabled)
        * */

        let available_variant_types = [];
        let selected_options = {};

        $('.quick-view-size-lists li').addClass('disabled');

        // get all selected attributes in {key:value} format
        quick_view_available_options.map(function (k, option) {
            let selected_option = $(option).find('li.active');
            let type = selected_option.closest('.quick-view-size-lists').data('type');
            let value = selected_option.data('displayValue');

            if (type) {
                available_variant_types.push(type);
            }

            if (type && value) {
                selected_options[type] = value;
            }
        });

        quickViewSyncImage(get_quick_view_selected_options());
        quickViewSyncPrice(get_quick_view_selected_options());
        quickViewSyncStock(get_quick_view_selected_options());

        // search in attribute_store for all available matches
        let available_variants_selection = [];
        let selected_attributes_by_type = {};
        quick_view_attribute_store.map(function (arr) {
            let matched = true;

            Object.keys(selected_options).map(function (type) {

                if (arr[type] !== selected_options[type]) {
                    matched = false;
                }
            })

            if (matched) {
                available_variants_selection.push(arr);

                // insert as {key: [value, value...]}
                Object.keys(arr).map(function (type) {
                    // not array available for the given key
                    if (!selected_attributes_by_type[type]) {
                        selected_attributes_by_type[type] = []
                    }

                    // insert value if not inserted yet
                    if (selected_attributes_by_type[type].indexOf(arr[type]) <= -1) {
                        selected_attributes_by_type[type].push(arr[type]);
                    }
                })
            }

            window.quick_view_selected_variant = selected_attributes_by_type;
        });

        // selected item not contain product then de-select all selected option hare
        if (Object.keys(selected_attributes_by_type).length == 0) {
            $('.quick-view-size-lists li.active').each(function () {
                let sizeItem = $(this).parent().parent();

                sizeItem.find('input[type=hidden]').val('');
                sizeItem.find('input[type=text]').val('');
            });

            $('.quick-view-size-lists li.active').removeClass("active");
            $('.quick-view-size-lists li.disabled').removeClass("disabled");

            let el = $(selected_item);
            let value = el.data('displayValue');
            let parentWrap = el.parent().parent();

            el.addClass("active");
            el.siblings().removeClass('active');

            selectedAttributeSearch();

            parentWrap.find('input[type=text]').val(value);
            parentWrap.find('input[type=hidden]').val(el.data('value'));
        }

        // keep only available matches selectable
        Object.keys(selected_attributes_by_type).map(function (type) {
            // initially, disable all buttons
            $('.quick-view-size-lists[data-type="' + type + '"] li').addClass('disabled');

            // make buttons selectable for the available options
            selected_attributes_by_type[type].map(function (value) {
                let available_buttons = $('.quick-view-size-lists[data-type="' + type + '"] li[data-display-value="' + value + '"]');
                available_buttons.map(function (key, el) {
                    $(el).removeClass('disabled');
                })
            })
        });
        // todo check is empty object
        // selected_attributes_by_type
    }

    function quickViewSyncImage(selected_options) {
        //todo fire when attribute changed
        let hashed_key = getQuickViewSelectionHash(selected_options);

        let product_image_el = $('.quick-view-long-img img');

        let img_original_src = product_image_el.parent().data('src');

        // if selection has any image to it
        if (quick_view_additional_info_store[hashed_key]) {
            let attribute_image = quick_view_additional_info_store[hashed_key].image;
            if (attribute_image) {
                product_image_el.attr('src', attribute_image);
            }
        } else {
            product_image_el.attr('src', img_original_src);
        }
    }

    function quickViewSyncPrice(selected_options) {
        let hashed_key = getQuickViewSelectionHash(selected_options);

        let product_price_el = $('#quick-view-price');
        let product_main_price = Number(String(product_price_el.data('mainPrice'))).toFixed(2);
        let site_currency_symbol = product_price_el.data('currencySymbol');

        // if selection has any additional price to it
        if (quick_view_additional_info_store[hashed_key]) {
            let attribute_price = quick_view_additional_info_store[hashed_key]['additional_price'];
            if (attribute_price) {
                let price = Number(product_main_price) + Number(attribute_price);
                product_price_el.text(site_currency_symbol + Number(price).toFixed(2));
            }
        } else {
            product_price_el.text(site_currency_symbol + product_main_price);
        }
    }

    function quickViewSyncStock(selected_options) {
        let hashed_key = getQuickViewSelectionHash(selected_options);
        let product_stock_el = $('#quick_view_stock');
        let product_item_left_el = $('#quick_view_item_left');

        // if selection has any size and color to it

        if (quick_view_additional_info_store[hashed_key]) {
            let stock_count = quick_view_additional_info_store[hashed_key]['stock_count'];

            let stock_message = '';
            if (Number(stock_count) > 0) {
                stock_message = `<span class="text-success">متوفر في المخزون</span>`;
                product_item_left_el.text(`Only! ${stock_count} Item Left!`);
                product_item_left_el.addClass('text-success');
                product_item_left_el.removeClass('text-danger');
            } else {
                stock_message = `<span class="text-danger">لدينا لمخزون</span>`;
                product_item_left_el.text(`No Item Left!`);
                product_item_left_el.addClass('text-danger');
                product_item_left_el.removeClass('text-success');
            }

            product_stock_el.html(stock_message);
        }else{
            product_stock_el.html(product_stock_el.data("stock-text"))
            product_item_left_el.html(product_item_left_el.data("stock-text"))
        }
    }

    function attributeSelected() {
        let total_options_count = $('.quick-view-size-lists').length;
        let selected_options_count = $('.quick-view-size-lists li.active').length;
        return total_options_count === selected_options_count;
    }

    function addslashes(str) {
        return (str + '').replace(/[\\"']/g, '\\$&').replace(/\u0000/g, '\\0');
    }

    function getQuickViewSelectionHash(selected_options) {
        return MD5(JSON.stringify(selected_options));
    }

    function get_quick_view_selected_options() {
        let selected_options = {};
        var quick_view_available_options = $('.quick-view-value-input-area');
        // get all selected attributes in {key:value} format
        quick_view_available_options.map(function (k, option) {
            let selected_option = $(option).find('li.active');
            let type = selected_option.closest('.quick-view-size-lists').data('type');
            let value = selected_option.data('displayValue');

            if (type && value) {
                selected_options[type] = value;
            }
        });

        let ordered_data = {};
        let selected_options_keys = Object.keys(selected_options).sort();
        selected_options_keys.map(function (e) {
            ordered_data[e] = selected_options[e];
        });

        return ordered_data;
    }

    function getQuickViewAttributesForCart() {
        let selected_options = get_quick_view_selected_options();
        let cart_selected_options = selected_options;
        let hashed_key = getQuickViewSelectionHash(selected_options);

        // if selected attribute set is available
        if (quick_view_additional_info_store[hashed_key]) {
            return quick_view_additional_info_store[hashed_key]['pid_id'];
        }

        // if selected attribute set is not available
        if  (Object.keys(selected_options).length) {
            toastr.error('الخاصية غير متوفرة')
        }

        return '';
    }

    function quickViewValidateSelectedAttributes() {
        let selected_options = get_quick_view_selected_options();
        let hashed_key = getQuickViewSelectionHash(selected_options);

        // validate if product has any attribute
        if (quick_view_attribute_store.length) {
            if (!Object.keys(selected_options).length) {
                return false;
            }

            if (!quick_view_additional_info_store[hashed_key]) {
                return false;
            }

            return !!quick_view_additional_info_store[hashed_key]['pid_id'];
        }

        return true;
    }

    $(document).on('click', '.quick_view_add_to_cart', function (e) {
        e.preventDefault();

        let selected_size = $('#selected_size').val();
        let selected_color = $('#selected_color').val();

        let pid_id = getQuickViewAttributesForCart();

        let product_id = quick_view_product_id;
        let quantity = Number($('#quick-view-quantity').val().trim());
        let price = $('#price').text().split(site_currency_symbol)[1];
        let attributes = {};
        let product_variant = pid_id;
        let productAttribute = quick_view_selected_variant;

        attributes['price'] = price;

        // if selected attribute is a valid product item
        if (quickViewValidateSelectedAttributes()) {
            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/cart/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: selected_size,
                    selected_color: selected_color,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        let track_icon_list = $('.track-icon-list');
                        track_icon_list.hide();
                        track_icon_list.load(location.href + " .track-icon-list");
                        track_icon_list.fadeIn();
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });
        } else {
            toastr.error('يرجي اختيار اللون والمقاس')
        }
    });

    $(document).on('click', '.quick_view_add_to_wishlist', function (e) {
        e.preventDefault();

        let quick_view_has_campaign = '0';
        let quick_view_campaign_expired = '0';

        if(quick_view_has_campaign === 1){
            if (quick_view_campaign_expired === 0){
                toastr.error('The campaign is over, Sorry! you can not cart this product');
                return false;
            }
        }

        let selected_size = $('#selected_size').val();
        let selected_color = $('#selected_color').val();

        let pid_id = getQuickViewAttributesForCart();

        let product_id = quick_view_product_id;
        let quantity = Number($('#quick-view-quantity').val().trim());
        let price = $('#price').text().split(site_currency_symbol)[1];
        let attributes = {};
        let product_variant = pid_id;
        let productAttribute = quick_view_selected_variant;

        attributes['price'] = price;

        // if selected attribute is a valid product item
        if (quickViewValidateSelectedAttributes()) {
            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/wishlist/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: selected_size,
                    selected_color: selected_color,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        $('.track-icon-list').load(location.href + " .track-icon-list");
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });
        } else {
            toastr.error('يرجي اختيار اللون والمقاس')
        }
    });

    $(document).on('click', '.quick_view_but_now', function (e) {
        e.preventDefault();

        let selected_size = $('#selected_size').val();
        let selected_color = $('#selected_color').val();

        let pid_id = getQuickViewAttributesForCart();

        let product_id = quick_view_product_id;
        let quantity = Number($('#quick-view-quantity').val().trim());
        let price = $('#price').text().split(site_currency_symbol)[1];
        let attributes = {};
        let product_variant = pid_id;
        let productAttribute = quick_view_selected_variant;

        attributes['price'] = price;

        // if selected attribute is a valid product item
        if (quickViewValidateSelectedAttributes()) {
            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/cart/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    pid_id: pid_id,
                    product_variant: product_variant,
                    selected_size: selected_size,
                    selected_color: selected_color,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                beforeSend: function () {

                },
                success: function (data) {
                    if (data.quantity_msg)
                    {
                        toastr.warning(data.quantity_msg);
                    }
                    else if(data.error_msg)
                    {
                        toastr.error(data.error_msg);
                    }
                    else
                    {
                        toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                        $('.track-icon-list').load(location.href + " .track-icon-list");
                    }

                    setTimeout(()=>{
                        location.href = "https://baby40.amstechs.com/shop/checkout";
                    }, 2000)
                },
                error: function (err) {
                    toastr.error('حدث خطأ')
                }
            });
        } else {
            toastr.error('يرجي اختيار اللون والمقاس')
        }
    });

    /* ========================================
                Product Quantity JS
    ========================================*/

    $(document).on('click', '.quick-view-plus', function () {
        var selectedInput = $(this).prev('.quick-view-quantity-input');
        if (selectedInput.val()) {
            selectedInput[0].stepUp(1);
        }
    });

    $(document).on('click', '.quick-view-substract', function () {
        var selectedInput = $(this).next('.quick-view-quantity-input');
        if (selectedInput.val() > 1) {
            selectedInput[0].stepDown(1);
        }
    });
</script>

<script>
    (function ($) {
        'use strict'

        $("#product_quick_view .modal-content.p-5").niceScroll();

        let site_currency_symbol = 'ج.م';

        $('body').on('click', '.quick-view-size-lists li', function (event) {
            let el = $(this);
            let value = el.data('displayValue');
            let parentWrap = el.parent().parent();
            el.addClass('active');
            el.siblings().removeClass('active');
            parentWrap.find('input[type=text]').val(value);
            parentWrap.find('input[type=hidden]').val(el.data('value'));

            // selected attributes
            selectedAttributeSearch(this);
        });

        function selectedAttributeSearch(selected_item) {
            /*
            * search based on all selected attributes
            *
            * 1. get all selected attributes in {key:value} format
            * 2. search in attribute_store for all available matches
            * 3. display available matches (keep available matches selectable, and rest as disabled)
            * */

            let available_variant_types = [];
            let selected_options = {};

            // get all selected attributes in {key:value} format
            quick_view_available_options.map(function (k, option) {
                let selected_option = $(option).find('li.active');
                let type = selected_option.closest('.quick-view-size-lists').data('type');
                let value = selected_option.data('displayValue');

                if (type) {
                    available_variant_types.push(type);
                }

                if (type && value) {
                    selected_options[type] = value;
                }
            });

            quickViewSyncImage(get_quick_view_selected_options());
            quickViewSyncPrice(get_quick_view_selected_options());

            // search in attribute_store for all available matches
            let available_variants_selection = [];
            let selected_attributes_by_type = {};
            quick_view_attribute_store.map(function (arr) {
                let matched = true;

                Object.keys(selected_options).map(function (type) {

                    if (arr[type] !== selected_options[type]) {
                        matched = false;
                    }
                })

                if (matched) {
                    available_variants_selection.push(arr);

                    // insert as {key: [value, value...]}
                    Object.keys(arr).map(function (type) {
                        // not array available for the given key
                        if (!selected_attributes_by_type[type]) {
                            selected_attributes_by_type[type] = []
                        }

                        // insert value if not inserted yet
                        if (selected_attributes_by_type[type].indexOf(arr[type]) <= -1) {
                            selected_attributes_by_type[type].push(arr[type]);
                        }
                    })
                }
            });

            // selected item not contain product then de-select all selected option hare
            if (Object.keys(selected_attributes_by_type).length == 0) {
                $('.quick-view-size-lists li.active').each(function () {
                    let sizeItem = $(this).parent().parent();

                    sizeItem.find('input[type=hidden]').val('');
                    sizeItem.find('input[type=text]').val('');
                });

                $('.quick-view-size-lists li.active').removeClass("active");
                $('.quick-view-size-lists li.disabled-option').removeClass("disabled-option");

                let el = $(selected_item);
                let value = el.data('displayValue');

                el.addClass("active");
                $(this).find('input[type=hidden]').val(value);
                $(this).find('input[type=text]').val(el.data('value'));

                selectedAttributeSearch();
            }

            // keep only available matches selectable
            Object.keys(selected_attributes_by_type).map(function (type) {
                // initially, disable all buttons
                $('.quick-view-size-lists[data-type="' + type + '"] li').addClass('disabled-option');

                // make buttons selectable for the available options
                selected_attributes_by_type[type].map(function (value) {
                    let available_buttons = $('.quick-view-size-lists[data-type="' + type + '"] li[data-display-value="' + value + '"]');
                    available_buttons.map(function (key, el) {
                        $(el).removeClass('disabled-option');
                    })
                })
            });
            // todo check is empty object
            // selected_attributes_by_type
        }

        function quickViewSyncImage(selected_options) {
            //todo fire when attribute changed
            let hashed_key = getQuickViewSelectionHash(selected_options);
            let product_image_el = $('.quick-view-long-img img');

            let img_original_src = product_image_el.parent().data('src');

            // if selection has any image to it
            if (quick_view_additional_info_store[hashed_key]) {
                let attribute_image = quick_view_additional_info_store[hashed_key].image;
                if (attribute_image) {
                    product_image_el.attr('src', attribute_image);
                }
            } else {
                product_image_el.attr('src', img_original_src);
            }
        }

        function quickViewSyncPrice(selected_options) {
            let hashed_key = getQuickViewSelectionHash(selected_options);

            let product_price_el = $('#quick-view-price');
            let product_main_price = Number(String(product_price_el.data('mainPrice'))).toFixed(2);
            let site_currency_symbol = product_price_el.data('currencySymbol');

            // if selection has any additional price to it
            if (quick_view_additional_info_store[hashed_key]) {
                let attribute_price = quick_view_additional_info_store[hashed_key]['additional_price'];
                if (attribute_price) {
                    let price = Number(product_main_price) + Number(attribute_price);
                    product_price_el.text(site_currency_symbol + Number(price).toFixed(2));
                }
            } else {
                product_price_el.text(site_currency_symbol + product_main_price);
            }
        }

        $('body').on('click', '.add_to_cart_single_page_quick_view',function (e) {
            e.preventDefault();
            let selected_size = $('#quick_view_selected_size').val();
            let selected_color = $('#quick_view_selected_color').val();

            $(".quick-view-size-lists.active")

            let pid_id = getQuickViewAttributesForCart();

            let product_id = $(this).data('id');
            let quantity = Number($('#quick-view-quantity').val().trim());
            let price = $('#quick-view-price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (quickViewValidateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/cart/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        attributes: attributes,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    success: function (data) {
                        toastr.success(data.msg);
                        if (data.quantity_msg) {
                            toastr.warning(data.quantity_msg)
                        }

                        refreshShippingDropdown();
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ');
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس');
            }
        });

        let productQuickViewModel = document.getElementById("product_quick_view");
        let defaultQuickViewModel = document.getElementById("quick_view");

        window.onclick = function (event){
            if(productQuickViewModel == event.target){
                $("#product_quick_view").fadeOut();
                setTimeout(function (){
                    $("#product_quick_view").empty();
                },200);
            }else if(defaultQuickViewModel == event.target){
                $("#quick_view").fadeOut();
                $("#quick_view").removeClass('show');
                $(".modal-backdrop").fadeOut();
            }

            $("html body").removeClass("stop-scroll")
        }

        $(document).on('click','.add_to_cart_ajax', function (e) {
            e.preventDefault();
            let product_id = $(this).data('id');
            let quickViewQty = $("#quantity_single_quick_view_btn").val();
            quickViewQty = quickViewQty != undefined ? quickViewQty.trim() : 1;
            let quantity = Number(quickViewQty);
            $.ajax({
                url: 'https://baby40.amstechs.com/shop/product/cart/add',
                type: 'POST',
                data: {
                    product_id: product_id,
                    quantity: quantity,
                    product_attributes: null,
                    _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                },
                success: function (data) {
                    toastr.success(data.msg);
                    if (data.quantity_msg) {
                        toastr.warning(data.quantity_msg)
                    }
                    refreshShippingDropdown();
                },
                error: function (err) {
                    toastr.error('حدث خطأ ما');
                }
            });
        });

        // open modal with product quick view
        $(document).on("click",".product-quick-view-ajax",function (){
            let action_route = $(this).data('action-route');

            let icon = $(this).find("i");
            let oldIconClass = icon.attr("class");
            icon.attr("class","las la-spinner icon la-spin");

            $.ajax({
                url: action_route,
                type: 'GET',
                success: function (data) {
                    icon.attr("class",oldIconClass);

                    $("#product_quick_view").html(data);
                    $("#product_quick_view").fadeIn();


                    $("html body").addClass("stop-scroll")
                },
                error: function (err) {
                    toastr.error('حدث خطأ');
                }
            });
        });

        // close quick view details model and make empty
        $(document).on("click","#product_quick_view .quick-view-close-btn",function (){
            $("#product_quick_view").fadeOut();

            setTimeout(function (){
                $("#product_quick_view").empty();
            },200);
        });

        $(document).on("click","#quick_view .quick-view-close-btn",function (){
            $("#quick_view").fadeOut();
            $("#quick_view").removeClass('show');
            $(".modal-backdrop").fadeOut();
        });

        $(document).on('click','.quick-view', function (e) {
            e.preventDefault();

            //todo: work on showing campaign date countdown


            let data = $(this).data();
            let rating = $(this).data('rating');
            let stock_msg = "المنتج غير متوفر في المخزون";
            let stock_msg_type = "text-danger";
            let quick_view = $('#quick_view');
            quick_view.find('.flash-countdown-wrapper').hide();
            if(data.iscampaign){
                quick_view.find('.flash-countdown-title').text(data.campaigntitle);
                quick_view.find('.flash-countdown-product-2').attr('data-date',data.campaigndate);
                let coundClass = quick_view.find('.flash-countdown-product-2');
                let oldId = quick_view.find('.flash-countdown-product-2').attr('id');
                coundClass.removeClass(oldId);
                oldId = oldId.substr(35);

                let newClassGen = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
                coundClass.addClass(oldId+newClassGen);
                coundClass.attr('id',oldId+newClassGen);

                loopcounter(quick_view.find('.flash-countdown-product-2').attr('id'));
                quick_view.find('.flash-countdown-wrapper').show();
            }


            quick_view.find('a.add-to-cart').data('id', data['id']);

            quick_view.find('.title').text(data['title']);
            quick_view.find('.info').text(data['summary']);
            quick_view.find('.del_price').text(data['price']);
            quick_view.find('.sale_price').text(data['salePrice']);
            quick_view.find('.product_category').text(data['category']);
            quick_view.find('.product_category').attr('href', data['categoryUrl']);
            quick_view.find('.product-img img').attr('src', data['image']);
            quick_view.find('.sku_wrapper .sku').text(data['inventory']);
            quick_view.find('.badge-tag').text(data['badge']);
            if(data['campaignPercentage']){
                quick_view.find('.discount-tag').text(data['campaignPercentage']);
            }else{
                quick_view.find('.discount-tag').text('');
            }

            quick_view.find('#unit').text(data['unit']);
            quick_view.find('#uom').text(data['uom']);

            // inventory
            if (data['inStock']) {
                stock_msg = "In stock " + data['inStock'];
                stock_msg_type = "text-success";
            }

            quick_view.find('.is_available').text(stock_msg);
            quick_view.find('.is_available').addClass(stock_msg_type);

            if (data['inventory'] && data['inventory'].length) {
                quick_view.find('.sku_wrapper').show();
            }

            // subcategory
            let subcategory_html = '';
            let subcategory = data['subcategory'];

            for (let i = 0; i < subcategory.length; i++) {
                let comma = '';
                if (i < subcategory.length - 1) {
                    comma += ', ';
                }
                subcategory_html += '<a href="' + subcategory[i]['url'] + '" class="tag-btn" rel="tag">' + subcategory[i]['name'] + '</a>' + comma;
            }

            quick_view.find('.subcategory_container').html(subcategory_html);

            if (!subcategory_html.length) {
                quick_view.find('.product-details-tag-and-social-link').hide();
            } else {
                quick_view.find('.product-details-tag-and-social-link').show();
            }

            if (subcategory_html.length <= 0) {
                $('.productview_subcategory').hide();
            } else {
                $('.productview_subcategory').show()
            }

            // rating
            let rating_html = '';
            for (let i = 0; i < Number(rating); i++) {
                rating_html += '<i class="las la-star icon"></i>';
            }

            for (let i = Math.ceil(Number(rating)); i < 5; i++) {
                rating_html += '<i class="lar la-star icon"></i>';
            }

            quick_view.find('.ratings').html(rating_html);

            if (Number(rating)) {
                quick_view.find('.ratings').show();
            } else {
                quick_view.find('.ratings').hide();
            }

            // quick_view.modal('show');
            $("#quick_view").fadeIn();
            $("#quick_view").addClass('show');
            $(".modal-backdrop").fadeIn();
        });

        $(document).ready(function () {
            refreshShippingDropdown();

            $('.add_to_cart_ajax_with_quantity').on('click', function (e) {
                e.preventDefault();
                let product_id = $(this).data('id');
                let quantity = $(this).closest('.product_card').find('.hover-content .qty_').val();
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/cart/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        product_attributes: null,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    success: function (data) {
                        if(data.type == 'danger'){
                            toastr.error(data.msg);
                        }else{
                            toastr.success(data.msg);
                        }

                        if (data.quantity_msg) {
                            toastr.warning(data.quantity_msg)
                        }
                        refreshShippingDropdown();
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ ما');
                    }
                });
            });

            $('.attribute input[type=radio]').on('click', function () {
                let attribute_img_el = $('.attribute_img');
                let total_extra = 0;
                let main_price = Number($('#price').data('mainPrice'));
                let all_checked = $('.attribute input[type=radio]:checked');

                // image
                if ($(this).data('attrImage')) {
                    attribute_img_el.attr('src', $(this).data('attrImage')).show();
                    attribute_img_el.closest('.single-main-image').find('.magnific').attr('href', $(this).data('attrImage'));
                    attribute_img_el.prev().hide();
                } else {
                    attribute_img_el.hide();
                    attribute_img_el.prev().show();
                }

                //price
                for (let i = 0; i < all_checked.length; i++) {
                    total_extra += Number($(all_checked[i]).siblings('span').data('extra'));
                }
                let new_price = main_price + total_extra;
                $('#price').text(site_currency_symbol + parseFloat(new_price).toFixed(2));
            });

            $('.add_to_wishlist_ajax').on('click', function (e) {
                e.preventDefault();
                let product_id = $(this).data('id');
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/wishlist/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: 1,
                        pid_id: null,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    success: function (data) {
                        toastr.success(data.msg);
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ ما');
                    }
                });
            });

            $('.nav_search_btn').on('click', function (e) {
                e.preventDefault();
                if ($('.search_bar .form-group .form-control').val().length) {
                    $('#product_search_form').trigger('submit');
                } else {
                    $('.search_bar .form-group').toggle('fast', 'swing');
                }
            });

            // view data with



            $('.add_to_compare_ajax').on('click', function (e) {
                e.preventDefault();
                let product_id = $(this).data('id');
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/compare/items',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    success: function (data) {
                        if (data) {
                            toastr.success('تمت إضافة العنصر للمقارنة');
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ ما');
                    }
                });
            });

            $('body').on('click','.add_to_compare_ajax_single_page_quick_view', function (e) {
                e.preventDefault();
                let product_id = $(this).data('id');
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/compare/items',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    success: function (data) {
                        if (data) {
                            toastr.success('تمت إضافة العنصر للمقارنة');
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ ما');
                    }
                });
            });

            $(document).on('click', '.quick-view', function (e) {
                e.preventDefault();
                loadProductAttributeHtml($(this).data('slug'));
            });

            $(document).on('click', '#close_search_dropdown', function (e) {
                $('.category-searchbar').hide();
            });

            $(document).on('focus', '#search_form_input', function (e) {
                if ($('#search_result_categories').html().length && $('#search_result_products').html().length) {
                    $('.category-searchbar').show();
                }
            });

            /* Nice Scroll */
            $(".category-searchbar").niceScroll({});
        });

        function refreshShippingDropdown() {

        }

        function loadFilterData(url) {
            $('.lds-ellipsis').show();
            $.ajax({
                url: url,
                type: 'GET',
                success: function (data) {
                    if (data) {
                        $('#product_filter_section').html(data);
                        $('.lds-ellipsis').hide();
                    }
                },
                error: function (err) {
                    toastr.error('حدث خطأ ما');
                    $('.lds-ellipsis').hide();
                }
            });
        }
    })(jQuery)

    function attributeSelected() {
        let total_options_count = $('.quick-view-size-lists').length;
        let selected_options_count = $('.quick-view-size-lists li.active').length;
        return total_options_count === selected_options_count;
    }

    function addslashes(str) {
        return (str + '').replace(/[\\"']/g, '\\$&').replace(/\u0000/g, '\\0');
    }

    function getQuickViewSelectionHash(selected_options) {
        return MD5(JSON.stringify(selected_options));
    }

    function get_quick_view_selected_options() {
        let selected_options = {};
        var quick_view_available_options = $('.quick-view-value-input-area');
        // get all selected attributes in {key:value} format
        quick_view_available_options.map(function (k, option) {
            let selected_option = $(option).find('li.active');
            let type = selected_option.closest('.quick-view-size-lists').data('type');
            let value = selected_option.data('displayValue');

            if (type && value) {
                selected_options[type] = value;
            }
        });

        let ordered_data = {};
        let selected_options_keys = Object.keys(selected_options).sort();
        selected_options_keys.map(function (e) {
            ordered_data[e] = selected_options[e];
        });

        return ordered_data;
    }

    function getQuickViewAttributesForCart() {
        let selected_options = get_quick_view_selected_options();
        let cart_selected_options = selected_options;
        let hashed_key = getQuickViewSelectionHash(selected_options);

        // if selected attribute set is available
        if (quick_view_additional_info_store[hashed_key]) {
            return quick_view_additional_info_store[hashed_key]['pid_id'];
        }

        // if selected attribute set is not available
        if  (Object.keys(selected_options).length) {
            toastr.error('الخاصية غير متوفرة')
        }

        return '';
    }

    function send_ajax_response_get_response(type,url){
        $.ajax({
            url: url,
            type: type,
            data: {
                style: "two",
                limit: $(".product-filter-two-wrapper").data("item-limit")
            },
            headers: {
                'X-CSRF-TOKEN': "WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi",
            },
            beforeSend:function (){
                $(".product-filter-two-wrapper").attr("style","height:912px");
                $(".filter-style-block-preloader.lds-ellipsis").show();
            },
            success: function (data) {
                $(".filter-style-block-preloader.lds-ellipsis").hide(300);
                $(".product-filter-two-wrapper").removeAttr("style");
                $(".product-filter-two-wrapper").html(data).removeAttr("style");

                if(data.success == false){
                    toastr.warning('There something is wrong please try again');
                }
            },
            error: function (err) {
                $(".product-filter-two-wrapper").removeAttr("style");
                $(".filter-style-block-preloader.lds-ellipsis").hide(300);
                toastr.error('حدث خطأ');
            }
        });
    }

    function quickViewValidateSelectedAttributes() {
        let selected_options = get_quick_view_selected_options();
        let hashed_key = getQuickViewSelectionHash(selected_options);

        // validate if product has any attribute
        if (quick_view_attribute_store.length) {
            if (!Object.keys(selected_options).length) {
                return false;
            }

            if (!quick_view_additional_info_store[hashed_key]) {
                return false;
            }

            return !!quick_view_additional_info_store[hashed_key]['pid_id'];
        }

        return true;
    }
</script>

    <script>
        $(function (){
            let starRatingControl = new StarRating('.star-rating', {
                maxStars: 5,
                clearable: false,
                stars: function (el, item, index) {
                    el.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect class="gl-star-full" width="19" height="19" x="2.5" y="2.5"/><polygon fill="#FFF" points="12 5.375 13.646 10.417 19 10.417 14.665 13.556 16.313 18.625 11.995 15.476 7.688 18.583 9.333 13.542 5 10.417 10.354 10.417"/></svg>';
                },
                classNames: {
                    active: 'gl-active',
                    base: 'gl-star-rating',
                    selected: 'rating-selected',
                },
            });

            /*========================================
                        CountDown Timer
            ========================================*/
            
            let year = '0';
            let month = '0';
            let day = '0';

            $('.global-timer').syotimer({
                year: year,
                month: month,
                day: day,
            });

            $(document).on('click', '.small-img', function (){
                let image = $(this).data('image-path');
                let long_img = $('.long-img img');

                long_img.hide();
                long_img.attr('src', image);
                long_img.fadeIn(100);
            });

            $(document).on('click', '#review-submit-btn', function (e){
                e.preventDefault();

                let product_id = '204';
                let selected_rating = $('.rating-selected').data('value');
                let review_text = $('#review-text').val();
                let submit_btn_el = $(this);

                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/review',
                    type: 'POST',
                    data: {
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi',
                        product_id: product_id,
                        review_text: review_text,
                        rating: selected_rating
                    },
                    beforeSend: function (){
                        toastr.warning('تقديم يرجى الانتظار.')
                        submit_btn_el.text('تقديم..');
                    },
                    success: function (data){
                        if (data.type === 'success')
                        {
                            toastr.success(data.msg)
                            setTimeout(() => {
                                location.reload();
                            }, 300);
                        } else {
                            toastr.error(data.msg)
                            submit_btn_el.closest('form')[0].reset();
                        }

                        submit_btn_el.text('إرسال مراجعة');
                    },
                    error: function (data){
                        var response = data.responseJSON.errors;
                        $.each(response, function (value, index) {
                            toastr.error(index, 5000)
                        });

                        submit_btn_el.text('إرسال مراجعة');
                    }
                });
            });

            $(document).on('click', '.see-more-review', function (){
                let el = $(this);
                let items = el.attr('data-items');

                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/review/more',
                    type: 'GET',
                    data: {
                        product_id: '204',
                        items: items,
                    },
                    beforeSend: function (){
                        el.text('Loading..');
                    },
                    success: function (data){
                        $('.all-reviews').html(data.markup).hide();
                        $('.all-reviews').fadeIn(800);
                        el.text('شاهد المزيد');

                        el.attr('data-items', Number(items)+5);
                    },
                    error: function (data){
                        el.text('شاهد المزيد');
                    }
                });
            })

            /* ========================================
                        Product Quantity JS
            ========================================*/

            $(document).on('click', '.plus', function () {
                var selectedInput = $(this).prev('.quantity-input');
                if (selectedInput.val()) {
                    selectedInput[0].stepUp(1);
                }
            });

            $(document).on('click', '.substract', function () {
                var selectedInput = $(this).next('.quantity-input');
                if (selectedInput.val() > 1) {
                    selectedInput[0].stepDown(1);
                }
            });
        });
    </script>

    <script>
        let attribute_store = JSON.parse('[{"Color":"Blue","Size":"Large"},{"Color":"Blue","Size":"Small"},{"Color":"Blue","Size":"Medium"},{"Color":"Green","Size":"Large"},{"Color":"Green","Size":"Small"},{"Color":"Green","Size":"Medium"},{"Color":"White","Size":"Large"},{"Color":"White","Size":"Small"},{"Color":"White","Size":"Medium"}]');
        let additional_info_store = JSON.parse('{"5122a8f747796022c35157b6f0a913b0":{"pid_id":5600,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-451716134679.jpg"},"044549540bc61dd2f07338c284468bc1":{"pid_id":5601,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-451716134679.jpg"},"7e97a256cd2d638b0d4062de746365f1":{"pid_id":5602,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-451716134679.jpg"},"0b1c7a8feee38dcce873fa25af903ac0":{"pid_id":5603,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-471716134671.jpg"},"030fcb2af1c30d26540242e2c5b05fae":{"pid_id":5604,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-471716134671.jpg"},"dd6ae3f7fa22a0c548aefd60472bd4dc":{"pid_id":5605,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-471716134671.jpg"},"eab83284516ffac21f28f05fc8b28e9e":{"pid_id":5606,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-461716134670.jpg"},"449a507a65967758973f9a32942f0c72":{"pid_id":5607,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-461716134670.jpg"},"33f980156b305f736ced9a3c7c924c17":{"pid_id":5608,"additional_price":"0.00","stock_count":"2","image":"https:\/\/baby40.amstechs.com\/assets\/tenant\/uploads\/media-uploader\/baby40\/tsmym-bdon-aanoan-461716134670.jpg"}}');
        let available_options = $('.value-input-area');
        let selected_variant = '';

        function getAttributesForCart() {
            let selected_options = get_selected_options();
            let cart_selected_options = selected_options;
            let hashed_key = getSelectionHash(selected_options);

            // console.log(selected_options, cart_selected_options, hashed_key, additional_info_store);return ;

            // if selected attribute set is available
            if (additional_info_store[hashed_key]) {
                return additional_info_store[hashed_key]['pid_id'];
            }

            // if selected attribute set is not available
            if (Object.keys(selected_options).length) {
                toastr.error('الخاصية غير متوفرة', 5000)
            }

            return '';
        }

        function get_selected_options() {
            let selected_options = {};
            let available_options = $('.value-input-area');
            // get all selected attributes in {key:value} format
            available_options.map(function (k, option) {
                let selected_option = $(option).find('li.active');
                let type = selected_option.closest('.size-lists').data('type');
                let value = String(selected_option.data('displayValue'));

                if (type && value) {
                    selected_options[type] = value;
                }
            });

            let ordered_data = {};
            let selected_options_keys = Object.keys(selected_options).sort();
            selected_options_keys.map(function (e) {
                ordered_data[e] = selected_options[e];
            });

            return ordered_data;
        }

        function getSelectionHash(selected_options) {
            return MD5(JSON.stringify(selected_options));
        }

        function validateSelectedAttributes() {
            let selected_options = get_selected_options();
            let hashed_key = getSelectionHash(selected_options);

            // validate if product has any attribute
            if (quick_view_attribute_store.length) {
                if (!Object.keys(selected_options).length) {
                    return false;
                }

                if (!additional_info_store[hashed_key]) {
                    return false;
                }

                return !!additional_info_store[hashed_key]['pid_id'];
            }

            return true;
        }

        (function ($) {
            'use script'

            $(document).ready(function () {
                $(document).on('click', '#login_submit_btn', function (e) {
                    e.preventDefault();

                    let el = $(this);
                    let username = $('#login_form_order_page input[name=email]').val();
                    let password = $('#login_form_order_page input[name=password]').val();
                    let remember = $('#login_form_order_page input[name=remember]').val();

                    el.text('الرجاء الانتظار..');

                    $.ajax({
                        type: 'post',
                        url: "https://baby40.amstechs.com/store-login",
                        data: {
                            _token: "WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi",
                            username: username,
                            password: password,
                            remember: remember,
                        },
                        success: function (data) {
                            if (data.status === 'invalid') {
                                el.text('تسجيل الدخول')
                                toastr.warning(data.msg );
                            } else {
                                el.text('تسجيل الدخول لترك تعليق');
                                toastr.success(data.msg );

                                setTimeout(() => {
                                    location.reload();
                                }, 300)
                            }
                        },
                        error: function (data) {
                            var response = data.responseJSON.errors;
                            $.each(response, function (value, index) {
                                toastr.error(index);
                            });
                            el.text('تسجيل الدخول');
                        }
                    });
                });

                $(document).on('click', '.size-lists li', function (event) {
                    let el = $(this);
                    let value = el.data('displayValue');
                    let parentWrap = el.parent().parent();
                    el.addClass('active');
                    el.siblings().removeClass('active');

                    // selected attributes
                    selectedAttributeSearch(this);

                    parentWrap.find('input[type=text]').val(value);
                    parentWrap.find('input[type=hidden]').val(el.data('value'));
                    console.log(value);
                });

                $(document).on('click', '.value-input-area', function () {
                    selectedAttributeSearch();
                });
            });
        })(jQuery)

        function selectedAttributeSearch(selected_item) {
            /*
            * search based on all selected attributes
            *
            * 1. get all selected attributes in {key:value} format
            * 2. search in attribute_store for all available matches
            * 3. display available matches (keep available matches selectable, and rest as disabled)
            * */

            let available_variant_types = [];
            let selected_options = {};

            $('.size-lists li').addClass('disabled');

            // get all selected attributes in {key:value} format
            available_options.map(function (k, option) {
                let selected_option = $(option).find('li.active');
                let type = selected_option.closest('.size-lists').data('type');
                let value = String(selected_option.data('displayValue'));

                if (type) {
                    available_variant_types.push(type);
                }

                if (type && value) {
                    selected_options[type] = value;
                }
            });


            syncImage(get_selected_options());
            syncPrice(get_selected_options());
            syncStock(get_selected_options());

            // search in attribute_store for all available matches
            let available_variants_selection = [];
            let selected_attributes_by_type = {};

            attribute_store.map(function (arr) {
                let matched = true;

                Object.keys(selected_options).map(function (type) {

                    if (arr[type] !== selected_options[type]) {
                        matched = false;
                    }
                })

                if (matched) {
                    available_variants_selection.push(arr);

                    // insert as {key: [value, value...]}
                    Object.keys(arr).map(function (type) {
                        // not array available for the given key
                        if (!selected_attributes_by_type[type]) {
                            selected_attributes_by_type[type] = []
                        }

                        // insert value if not inserted yet
                        if (selected_attributes_by_type[type].indexOf(arr[type]) <= -1) {
                            selected_attributes_by_type[type].push(arr[type]);
                        }
                    })
                }
            });

            // selected item not contain product then de-select all selected option here
            if (Object.keys(selected_attributes_by_type).length == 0) {
                $('.size-lists li.active').each(function () {
                    let sizeItem = $(this).parent().parent();

                    sizeItem.find('input[type=hidden]').val('');
                    sizeItem.find('input[type=text]').val('');
                });

                $('.size-lists li.active').removeClass("active");
                $('.size-lists li.disabled').removeClass("disabled");

                let el = $(selected_item);
                let value = el.data('displayValue');

                el.addClass("active");
                $(this).find('input[type=hidden]').val(value);
                $(this).find('input[type=text]').val(el.data('value'));

                selectedAttributeSearch();
            }

            // keep only available matches selectable

            Object.keys(selected_attributes_by_type).map(function (type) {
                // initially, disable all buttons

                // make buttons selectable for the available options
                selected_attributes_by_type[type].map(function (value) {
                    let available_buttons = $('.size-lists[data-type="' + type + '"] li[data-display-value="' + value + '"]');
                    available_buttons.map(function (key, el) {
                        $(el).removeClass('disabled');
                    })
                })
            });
            // todo check is empty object
            // selected_attributes_by_type
            selected_variant = selected_attributes_by_type;
        }

        function getSelectedOptions() {
            let selected_options = {};

            // get all selected attributes in {key:value} format
            available_options.map(function (k, option) {
                let selected_option = $(option).find('li.active');
                let type = selected_option.closest('.size-lists').data('type');
                let value = selected_option.data('displayValue');

                if (type && value) {
                    selected_options[type] = value;
                }
            });

            return selected_options;
        }

        function validateSelectedAttributes() {
            let selected_options = get_selected_options();
            let hashed_key = getSelectionHash(selected_options);

            // validate if product has any attribute
            if (attribute_store.length) {
                if (!Object.keys(selected_options).length) {
                    return false;

                }
                if (!additional_info_store[hashed_key]) {
                    return false;

                }
                return !!additional_info_store[hashed_key]['pid_id'];

            }

            return true;
        }

        function syncImage(selected_options) {
            //todo fire when attribute changed
            let hashed_key = getSelectionHash(selected_options);
            //single-main-image slick-slide slick-current slick-active
            let product_image_el = $('#shop_details_gallery_slider .long-img img');

            let img_original_src = product_image_el.parent().data('src');

            // if selection has any image to it
            if (additional_info_store[hashed_key]) {
                let attribute_image = additional_info_store[hashed_key].image;
                if (attribute_image) {
                    product_image_el.attr('src', attribute_image);
                    product_image_el.parent().attr('data-src', attribute_image);
                    //change zoom image also
                }
            } else {
                product_image_el.attr('src', img_original_src);
                product_image_el.parent().attr('data-src', img_original_src);
                //change zoom image also
            }
        }

        function syncPrice(selected_options) {
            let hashed_key = getSelectionHash(selected_options);

            let product_price_el = $('#price');
            let product_main_price = Number(String(product_price_el.data('mainPrice'))).toFixed(2);
            let site_currency_symbol = product_price_el.data('currencySymbol');

            // if selection has any additional price to it

            if (additional_info_store[hashed_key]) {
                let attribute_price = additional_info_store[hashed_key]['additional_price'];
                if (attribute_price) {
                    let price = Number(product_main_price) + Number(attribute_price);
                    product_price_el.text(site_currency_symbol + Number(price).toFixed(2));
                }
            } else {
                product_price_el.text(site_currency_symbol + product_main_price);
            }
        }

        function syncStock(selected_options) {
            let hashed_key = getSelectionHash(selected_options);
            let product_stock_el = $('#stock');
            let product_item_left_el = $('#item_left');

            // if selection has any size and color to it

            if (additional_info_store[hashed_key]) {
                let stock_count = additional_info_store[hashed_key]['stock_count'];

                let stock_message = '';
                if (Number(stock_count) > 0) {
                    stock_message = `<span class="text-success">متوفر في المخزون</span>`;
                    product_item_left_el.text(`فقط! ${stock_count} Item Left!`);
                    product_item_left_el.addClass('text-success');
                    product_item_left_el.removeClass('text-danger');
                } else {
                    stock_message = `<span class="text-danger">لدينا لمخزون</span>`;
                    product_item_left_el.text(`لم يتبق أي عنصر!`);
                    product_item_left_el.addClass('text-danger');
                    product_item_left_el.removeClass('text-success');
                }

                product_stock_el.html(stock_message);

            }else{
                product_stock_el.html(product_stock_el.data("stock-text"))
                product_item_left_el.html(product_item_left_el.data("stock-text"))
            }
        }

        $(document).on('click', '.add_to_cart_single_page', function (e) {
            e.preventDefault();

            let selected_size = $('#selected_size').val();
            let selected_color = $('#selected_color').val();

            let pid_id = getAttributesForCart();

            let product_id = '204';
            let quantity = Number($('#quantity').val().trim());
            let price = $('#price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;
            let productAttribute = selected_variant;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (validateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/cart/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    beforeSend: function () {

                    },
                    success: function (data) {
                        if (data.quantity_msg)
                        {
                            toastr.warning(data.quantity_msg);
                        }
                        else if(data.error_msg)
                        {
                            toastr.error(data.error_msg);
                        }
                        else
                        {
                            toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                            $('.track-icon-list').hide();
                            $('.track-icon-list').load(location.href + " .track-icon-list");
                            $('.track-icon-list').fadeIn();
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ')
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس')
            }
        });

        $(document).on('click', '.add_to_wishlist_single_page', function (e) {
            e.preventDefault();

            let selected_size = $('#selected_size').val();
            let selected_color = $('#selected_color').val();

            let pid_id = getAttributesForCart();

            let product_id = '204';
            let quantity = Number($('#quantity').val().trim());
            let price = $('#price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;
            let productAttribute = selected_variant;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (validateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/wishlist/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    beforeSend: function () {

                    },
                    success: function (data) {
                        if (data.quantity_msg)
                        {
                            toastr.warning(data.quantity_msg);
                        }
                        else if(data.error_msg)
                        {
                            toastr.error(data.error_msg);
                        }
                        else
                        {
                            toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                            $('.track-icon-list').load(location.href + " .track-icon-list");
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ')
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس')
            }
        });


        $(document).on('click', '.compare-btn', function (e) {
            e.preventDefault();

            let selected_size = $('#selected_size').val();
            let selected_color = $('#selected_color').val();

            let pid_id = getAttributesForCart();

            let product_id = '204';
            let quantity = Number($('#quantity').val().trim());
            let price = $('#price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;
            let productAttribute = selected_variant;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (validateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/compare/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    beforeSend: function () {

                    },
                    success: function (data) {
                        if (data.quantity_msg)
                        {
                            toastr.warning(data.quantity_msg);
                        }
                        else if(data.error_msg)
                        {
                            toastr.error(data.error_msg);
                        }
                        else
                        {
                            toastr.success(data.msg, 'اذهب إلى عربة التسوق', '#', 60000);
                            $('.track-icon-list').load(location.href + " .track-icon-list");
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ')
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس')
            }
        });

        $(document).on('click', '.but_now_single_page', function (e) {
            e.preventDefault();

            let selected_size = $('#selected_size').val();
            let selected_color = $('#selected_color').val();

            let pid_id = getAttributesForCart();

            let product_id = '204';
            let quantity = Number($('#quantity').val().trim());
            let price = $('#price').text().split(site_currency_symbol)[1];
            let attributes = {};
            let product_variant = pid_id;
            let productAttribute = selected_variant;

            attributes['price'] = price;

            // if selected attribute is a valid product item
            if (validateSelectedAttributes()) {
                $.ajax({
                    url: 'https://baby40.amstechs.com/shop/product/buy/add',
                    type: 'POST',
                    data: {
                        product_id: product_id,
                        quantity: quantity,
                        pid_id: pid_id,
                        product_variant: product_variant,
                        selected_size: selected_size,
                        selected_color: selected_color,
                        _token: 'WB8Dos3waeGi61tDeEk6qHP2OC0yzETog6FZvDsi'
                    },
                    beforeSend: function () {

                    },
                    success: function (data) {
                        if (data.quantity_msg)
                        {
                            toastr.warning(data.quantity_msg, 5000);
                        }
                        else if(data.error_msg)
                        {
                            toastr.error(data.error_msg, 5000);
                        }

                        if(data.type === 'success')
                        {
                            toastr.success(data.msg);
                            setTimeout(()=>{
                                location.href = data.redirect;
                            }, 2000)
                        }
                    },
                    error: function (err) {
                        toastr.error('حدث خطأ', 5000)
                    }
                });
            } else {
                toastr.error('يرجي اختيار اللون والمقاس', 5000)
            }
        });
    </script>

<script>
    // ننتظر حتى تحميل جميع الصور في الـ slider
    window.addEventListener('load', () => {
        // اختيار جميع الصور داخل الـ slider
        const zoomedImages = document.querySelectorAll('.zoom-container img'); // تأكد أن جميع الصور داخل الـ slider تحمل علامة <img>

        zoomedImages.forEach(zoomedImg => {
            const zoomContainer = zoomedImg.closest('.zoom-container');

            // تطبيق حركة الماوس لكل صورة
            zoomContainer.addEventListener('mousemove', (e) => {
                if (zoomedImg.classList.contains('zoom-in')) {
                    const containerRect = zoomContainer.getBoundingClientRect();

                    const mouseX = (e.clientX - containerRect.left) / containerRect.width;
                    const mouseY = (e.clientY - containerRect.top) / containerRect.height;

                    zoomedImg.style.transformOrigin = `${mouseX * 100}% ${mouseY * 100}%`;
                }
            });

            // عند الضغط على الصورة لتفعيل أو إلغاء التكبير
            zoomedImg.addEventListener('click', () => {
                if (zoomedImg.classList.contains('zoom-in')) {
                    zoomedImg.classList.remove('zoom-in');
                    zoomedImg.style.transformOrigin = 'center center';
                } else {
                    zoomedImg.classList.add('zoom-in');
                }
            });
        });
    });
</script>

